{% comment %}
  Article card component for grids 

  Accepts:
  - section: {Object} Section paramatres object

  Usage:
  {% render 'article-card' section:section, article:article %}
{% endcomment %}
{%- assign last_characters = 'general.abbreviation_of_text_in_a_section.last_characters' | t -%}
<div class="blog-posts {% if section.settings.image_hover == "default" %}{{ settings.image_hover }}{% else %}{{ section.settings.image_hover }}{% endif %}">
  {%- if section.settings.show_image and article.image != blank -%}
  <a href="{{ article.url }}" class="image-hover-box__container{% if section.settings.image_ratio == '1.00' %} image-hover-box--circle{% endif %}">
    {%- render "component-image",
        image_ratio_value: section.settings.image_ratio,
        image_source: article.image
    -%}
  </a>
  {%- endif -%}

  {%- capture content -%}
  {%- liquid
  if section.settings.showtags and article.tags.size > 0
  assign tags = true
  else
  assign tags = false
  endif
  -%}
  {%- if tags or section.settings.show_date or section.settings.show_author -%}
  <ul class="unstyle-ul blog-posts__meta body3">
    {%- if section.settings.show_date -%}
    <li class="author-toolbar__item" itemprop="dateCreated pubdate datePublished">
      {{- 'icon-calendar' | append: settings.system_icon_thickness | inline_asset_content -}}<span>{{- article.published_at | time_tag: format: "month_day_year" -}}</span>
    </li>
    {%- endif -%}            
    {%- if section.settings.show_author -%}
    <li class="author-toolbar__item" itemprop="author" itemscope itemtype="http://schema.org/Person">
      {{- 'icon-account' | append: settings.system_icon_thickness | inline_asset_content -}}<span itemprop="name">{{ article.author -}}</span>
    </li>
    {%- endif -%}
    {%- if tags -%}
    <li class="author-toolbar__item author-toolbar__item__tags">
	  {{- 'icon-discount-2' | append: settings.system_icon_thickness | inline_asset_content -}}
      <span>
        {% for tag in article.tags %}
        {%- assign tag_html = "<span>" | append: tag | append: "</span>" -%}
        {{ tag_html | link_to_tag: tag | replace: '<a', '<a class="link link__base-to_accent-color"' }}{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </span>
    </li>
    {%- endif -%}
  </ul>
  {%- endif -%}

  {{ '<' | append: section.settings.heading_size }} class="blog-posts__heading mt0 mb0">
  <a href="{{ article.url }}" class="clear-underline heading-color-block-hover a--no-hover-color{% if section.settings.hover_underline %} animation-underline{% endif %}">
    {%- if section.settings.truncate_post_heading -%}
    {{ article.title | escape | truncate: 63,last_characters }}
    {%- else -%}
    {{ article.title | escape }}
    {%- endif -%}
  </a>
  {{ '</' | append: section.settings.heading_size }}>
  
  {%- if section.settings.excerpt != 'hide' -%}
  {%- if article.excerpt.size > 0 or article.content.size > 0 -%}
  <div class="blog-posts__excerpt section__richtext__editor">
    {%- if article.excerpt.size > 0 -%}
      {%- if section.settings.excerpt == 'show_truncated' -%}
      {{ article.excerpt | strip_html | truncatewords: 20,last_characters }}
      {%- else -%}
      {{ article.excerpt }}
      {%- endif -%}
    {%- else -%}
      {%- if section.settings.excerpt == 'show_truncated' -%}
      {{ article.content | strip_html | truncatewords: 20,last_characters }}
      {%- else -%}
      {{ article.content }}
      {%- endif -%}
    {%- endif -%}
  </div>
  {%- endif -%}
  {%- endif -%}

  {%- if section.settings.show_button -%}
  <div class="blog-posts__btn">
    <a href="{{ article.url }}" class="btn btn-small-width btn__transition-text clear-underline">
      <div class="btn__texts">
        <span class="btn__top-text is-visible">{{ "blogs.card.learn_more" | t }}</span>
        <span class="btn__bottom-text is-hidden">{{ "blogs.card.learn_more" | t }}</span>
      </div>
    </a>
  </div>
  {%- endif -%}

  {%- if blog.comments_enabled? and section.settings.show_comment_count -%}
  {%- if article.comments.size > 0 -%}{%- assign comment_url = article.url | append: '#comments' -%}{%- else -%}{%- assign comment_url = article.url | append: '#addcomment' -%}{%- endif -%}
  <div class="blog-posts__comments__container">
    <div class="blog-posts__comments body3">
      <a href="{{ comment_url }}" class="clear-underline">
		{{- 'icon-chat' | append: settings.system_icon_thickness | inline_asset_content -}}
        {{ article.comments_count }}
      </a>
    </div>
  </div>
  {%- endif -%}
  {%- endcapture -%}
  {%- if content != blank -%}
  <div class="blog-posts__container">
    {{ content }}
  </div>
  {%- endif -%}
</div>