{% comment %}
  Mobile menu
  
  Accepts:
  - linklist: {Object} navigation links
  - show_icon: {Boolean} Show menu icon
  - svg_icons: {Object} svg icons

  Usage:
  {% render 'menu-drawer', linklist:section.settings.menu.links, show_icon:true, svg_icons:svg_icons %}
{% endcomment %}
{%- if linklist != blank -%}
<nav class="menu-drawer__navigation menu-drawer__links-padding{% if type != "main-menu" %} drawer-nav-secondary{% endif %}">
  <ul class="unstyle-ul">   
    {%- for link in linklist -%}
    {%- if link.links != blank -%}
    <li>
      <details>
        <summary>
          <div class="menu-drawer__menu-item{% if type == "main-menu" %} h4 menu-drawer__menu-item__main{% endif %}{% if link.current or link.child_active %} menu-drawer__menu-item--active{% endif %}">
            {%- if show_icon -%}
            {%- render 'get-menu-icon-code', icons:svg_icons, forloop_index:forloop.index, icons_size:30 -%}
            {%- endif -%}
            <span>{{ link.title | escape }}</span>
            {%- render "menu-badge" item_name:link.title -%}
            {{- 'icon-arrow-right-small' | append: settings.system_icon_thickness | inline_asset_content -}}
          </div>
        </summary>        
        <div class="menu-drawer__submenu">
          <div class="menu-drawer__inner-submenu">
            <ul class="unstyle-ul menu-drawer__submenu-content">
              <li>
                <button class="menu-drawer__back-button menu-drawer__menu-item link">
                  {{- 'icon-arrow-left-2' | append: settings.system_icon_thickness | inline_asset_content -}}
                </button>
              </li>
              <li>
                <a href="{{ link.url }}" class="menu-drawer__menu-item menu-drawer__menu-item__link h4{% if type == "main-menu" %} menu-drawer__menu-item__main{% endif %}{% if link.current or link.child_active %} menu-drawer__menu-item--active{% endif %}">
                  {{ link.title | escape }}{%- render "menu-badge" item_name:link.title -%}
                </a>
              </li>
              {%- for childlink in link.links -%}
              {%- if childlink.links != blank -%}
              <li>
                <details>
                  <summary>
                    <div class="menu-drawer__menu-item{% if type == "main-menu" %} h5{% else %} body2{% endif %}{% if childlink.current or childlink.child_active %} menu-drawer__menu-item--active{% endif %}">
                      <span>{{ childlink.title | escape }}</span>{%- render "menu-badge" item_name:childlink.title -%} {{- 'icon-arrow-right-small' | append: settings.system_icon_thickness | inline_asset_content -}}
                    </div>
                  </summary>

                  <div class="menu-drawer__submenu">
                    <div class="menu-drawer__inner-submenu">
                      <ul class="unstyle-ul menu-drawer__submenu-content">
                        <li>
                          <button class="menu-drawer__back-button menu-drawer__menu-item link">
                            {{- 'icon-arrow-left-2' | append: settings.system_icon_thickness | inline_asset_content -}}
                          </button>
                        </li>
                        <li>
                          <a href="{{ childlink.url }}" class="menu-drawer__menu-item menu-drawer__menu-item__link h4{% if type == "main-menu" %} menu-drawer__menu-item__main{% endif %}{% if childlink.current or childlink.child_active %} menu-drawer__menu-item--active{% endif %}">
                            {{ childlink.title | escape }}{%- render "menu-badge" item_name:childlink.title -%}
                          </a>
                        </li>
                        {%- for grandchildlink in childlink.links -%}
                        <li>
                          <a href="{{ grandchildlink.url }}" class="menu-drawer__menu-item{% if type == "main-menu" %} h5{% else %} body2{% endif %}{% if grandchildlink.current %} menu-drawer__menu-item--active{% endif %}">
                            {{ grandchildlink.title | escape }}{%- render "menu-badge" item_name:grandchildlink.title -%}
                          </a>
                        </li>
                        {%- endfor -%}
                      </ul>
                    </div>
                  </div>

                </details>
              </li>
              {%- else -%}
              <li>
                <a href="{{ childlink.url }}" class="menu-drawer__menu-item{% if type == "main-menu" %} h5{% else %} body2{% endif %}{% if childlink.current %} menu-drawer__menu-item--active{% endif %}">
                  {{ childlink.title | escape }}{%- render "menu-badge" item_name:childlink.title -%}
                </a>
              </li>
              {%- endif -%}
              {%- endfor -%}
            </ul>
          </div>
        </div>

      </details>
    </li>
    {%- else -%}
    <li>
      <a href="{{ link.url }}" class="menu-drawer__menu-item{% if type == "main-menu" %} h4 menu-drawer__menu-item__main{% endif %}{% if link.current %} menu-drawer__menu-item--active{% endif %}">
        {%- if show_icon -%}
        {%- render 'get-menu-icon-code', icons:svg_icons, forloop_index:forloop.index -%}
        {%- endif -%}
        <span>{{ link.title | escape }}</span>{%- render "menu-badge" item_name:link.title -%}
      </a>
    </li>
    {%- endif -%}
    {%- endfor -%}
  </ul>
</nav>
{%- endif -%}