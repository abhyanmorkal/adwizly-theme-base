{%- capture page_width -%}{%- if section.settings.width != "default" %}{{ section.settings.width }}{%- else -%}{{ settings.page_width_main }}{%- endif -%}{%- endcapture -%}

{{ 'section-password-header.css' | asset_url | stylesheet_tag }}
{{ 'component-inputs.css' | asset_url | stylesheet_tag }}
<link rel="stylesheet" href="{{ 'component-modal.css' | asset_url }}" media="print" onload="this.media='all'">

<header id="theme-section-{{ section.id }}"
     class="password-header{% if section.settings.show_bottom_line %} password-header--bottom-line{% endif %}"
     data-section-name="main-password-header">
  <div class="{{ page_width }}">
    <div class="mobile-header">
      {%- capture logo -%}
      {%- if request.page_type == 'index' -%}
      <h4 class="header__heading">
      {%- else -%}
      <div>
      {%- endif -%}
        <a href="{{ routes.root_url }}" class="header__heading-link clear-underline">
          {%- assign logo_svg_mobile = section.settings.logo_svg_mobile -%}
          {%- assign image_src = section.settings.logo_mobile -%}
          {%- assign logo_max_width = section.settings.logo_max_width_mobile -%}
          {%- if logo_svg_mobile != blank -%}
          {%- assign width = logo_svg_mobile | split: 'width="' | last | split: '"' | first | times: 1.0 -%}
          {%- assign height = logo_svg_mobile | split: 'height="' | last | split: '"' | first | plus: 0 -%}
          {%- assign aspect_ratio = height | divided_by: width -%}
          <div class="header__heading-logo--svg" style="--max-width: {{ logo_max_width }}px; --max-height: {{ logo_max_width | times: aspect_ratio }}px;">
            {{ logo_svg_mobile }}
          </div>
          {%- elsif image_src -%}
          {%- assign image_size_2x = logo_max_width | times: 2 | at_most: 5760 -%}
          <img srcset="{{ image_src | image_url: width: logo_max_width }} 1x, {{ image_src | image_url: width: image_size_2x }} 2x"
               src="{{ image_src | image_url: width: logo_max_width }}"
               class="header__heading-logo"
               alt="{{ image_src.alt | default: shop.name | escape }}"
               style="max-width: {{ logo_max_width }}px"
               width="{{ logo_max_width }}"
               height="{{ logo_max_width | divided_by: image_src.aspect_ratio }}"
               loading="lazy"
               >
          {%- else -%}
          <span class="h5">{{ shop.name }}</span>
          {%- endif -%}
        </a>
      {%- if request.page_type != 'index' -%}  
      </div>
      {%- else -%}
      </h4>
      {%- endif -%}
      {%- endcapture -%}
      <div class="logo-icon">{{ logo }}</div>
      <div class="password-button">
        <modal-opener class="display-flex popup-modal__opener" data-modal="#Password-message">
          <button id="Password-button-message"
                  class="link link--medium"
                  type="button" aria-haspopup="dialog"
            >{{- 'icon-lock' | append: settings.system_icon_thickness | inline_asset_content -}}</button>
        </modal-opener>
      </div>
    </div>
    <div class="desktop-header">
      {%- capture logo -%}{%- render "header-logo-desktop",section:section -%}{%- endcapture -%}
      <div class="logo-icon">{{ logo }}</div>
      <div class="password-button">
        <modal-opener class="display-flex popup-modal__opener" data-modal="#Password-message">
          <button id="Password-button-message"
                  class="link link--medium"
                  type="button" aria-haspopup="dialog"
            >{{- 'icon-lock' | append: settings.system_icon_thickness | inline_asset_content -}}{{ 'general.password_page.login_password_button' | t }}</button>
        </modal-opener>
      </div>
    </div>
  </div>
</header>
<modal-dialog id="Password-message" class="popup-modal popup-modal__right">
  <div class="popup-modal__overlay" onclick="this.closest('.popup-modal').close()"></div>
  <div class="popup-modal__content popup-modal__content__f-height">
    <button class="popup-modal__toggle modal-close-animation" type="button" onclick="this.closest('.popup-modal').close()" aria-label="{{ 'accessibility.close' | t }}">
	  {{- 'icon-close' | append: settings.system_icon_thickness | inline_asset_content -}}
    </button>
    <div class="popup-modal__content__data custom__scrollbar" role="dialog" aria-modal="true" tabindex="-1">
      <div class="popup-modal__content__header pickup-availability-header text-center">
        <h4 class="mt0">{{ 'general.password_page.login_form_heading' | t }}</h4>
      </div>
      <div class="popup-modal__content__content popup-modal__content__content--padding mt--first-child-0 body2">
        {%- form 'storefront_password', class: 'password-form' -%}
          <div class="field field-with-icon">
            <input class="field__input"
              autocomplete="current-password"
              type="password"
              id="Password"
              name="password"
              {% if form.errors %}
                aria-invalid="true"
                aria-describedby="PasswordLoginForm-password-error"
              {%- endif -%}
              placeholder="{{ 'general.password_page.login_form_password_placeholder' | t }}"
            >
            {%- if form.errors -%}
            <label class="field__label field__label--error" for="Password-error--{{ section.id }}">{{ 'general.password_page.login_form_error' | t -}}</label>
            {%- else -%}
            <label class="field__label" for="Password">{{- 'general.password_page.login_form_password_placeholder' | t -}}</label>
            {%- endif -%}
          
            <div class="field__icon">{{- 'icon-lock' | append: settings.system_icon_thickness | inline_asset_content -}}</div>
        
            <button type="submit" class="field__button btn__transition-text" name="commit" aria-label="{{ 'general.password_page.login_form_submit' | t }}">
              <span class="btn__top-text is-visible">{{- 'icon-arrow-right-2' | append: settings.system_icon_thickness | inline_asset_content -}}</span>
              <span class="btn__bottom-text is-hidden">{{- 'icon-arrow-right-2' | append: settings.system_icon_thickness | inline_asset_content -}}</span>
            </button>
          </div>
        {%- endform -%}
    
        <p class="body3 text-center mt40">{{ 'general.password_page.admin_link_html' | t }}</p>
      </div>
    </div>
  </div>
</modal-dialog>


{% schema %}
  {
    "name": "Header",
    "settings": [
      {
        "type": "select",
        "id": "width",
        "options": [
          {
            "value": "default",
            "label": "Default"
          },
          {
            "value": "page-width",
            "label": "Boxed"
          },
          {
            "value": "page-wide",
            "label": "Wide"
          }
        ],
        "default": "default",
        "label": "Width",
        "info": "The Wide option works for screens with 1440px width and more."
      },
      {
        "type": "checkbox",
        "id": "show_bottom_line",
        "default": true,
        "label": "Show bottom line"
      },
      {
        "type": "header",
        "content": "Desktop logo"
      },
      {
        "type": "image_picker",
        "id": "logo",
  	  "label": "Image"
      },
      {
        "type": "html",
        "id": "logo_svg",
        "label": "Svg code",
  	  "info": "Use instead of an image. SVG should have width and height attributes."
      },
      {
        "type": "range",
        "id": "logo_max_width",
        "min": 50,
        "max": 250,
        "step": 10,
        "default": 100,
        "unit": "px",
        "label": "Logo width"
      },
      {
        "type": "header",
        "content": "Mobile logo"
      },
      {
        "type": "image_picker",
        "id": "logo_mobile",
        "label": "Image"
      },
      {
        "type": "html",
        "id": "logo_svg_mobile",
        "label": "Svg code",
  	  "info": "Use instead of an image. SVG should have width and height attributes."
      },
      {
        "type": "range",
        "id": "logo_max_width_mobile",
        "min": 50,
        "max": 150,
        "step": 10,
        "default": 100,
        "unit": "px",
        "label": "Logo width"
      }
    ]
  }
{% endschema %}